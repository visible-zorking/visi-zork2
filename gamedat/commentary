# Game commentary source.

# Formatting:
# [*LINK]: Jump to a new note; also display source if possible. (Default behavior.)
# [~LINK]: Display source for LINK, but keep this note open.
# [text|*LINK], [text|~LINK]: Specify link text.
# [text|https://...] External link.

ABOUT: Welcome to the commentary track!

const:ZORK-NUMBER: The number of the Zorks shall be two.
	(“Three, sir!”)
	Yes, but *this* one is Zork 2.

rtn:V-VERSION: Print the title, release, and serial number.
	This function is shared between all three Zorks, which is why it has code to print all three titles. The passages meant for Zork 1 and 3 were ignored when compiling Zork 2. (Skipped code is shown in grey.)

src:GVERBS-89: The TRS-80 interpreter set a special bit which told the game to change certain behavior for no-doubt-contractual reasons. For Zork 2, it adds the line “Licensed to Tandy Corporation”.
	For a complete list of “Tandy bit” behavior changes in Infocom games, [see this page|https://ifarchive.org/if-archive/infocom/info/tandy_bits.html].


GRAMMAR-LEGEND: This is the list of verb forms which the game recognizes. (Simple directions like `NORTH` are a special case; they’re not listed here.) These are compiled from the [GSYNTAX|~src:GSYNTAX-71] file.
	Objects in a verb line have various flags which give hints about their usage. An object attribute (like `LIGHTBIT`) means that if the player doesn’t name an object, the parser will try to guess one with that attribute.
	The other flag letters have specific meanings: the object must be **h**eld; the object will be **t**aken if not held; the object should be **i**n the room or **o**n the ground; the object should be **p**ossessed or **c**arried in a container. (Yes, they’re confusing. Infocom’s own docs say “No one really understands them except Stu” (Galley).)

attr:RMUNGBIT: Not applied to real objects. `RMUNGBIT` is a hack used in grammar lines; it means the object is optional (but the preposition before it is required). This allows the parser to accept commands like [LOOK AROUND|~src:GSYNTAX-289].

glob:P-SYNTAX: The grammar line found when the most recent command was parsed. (Except for simple direction commands, which are a special case.) See the Grammar tab.


OBJTREE-LEGEND: In this list, `Rooms` are rooms and `Items` are regular items. (Sometimes portable, sometimes not.)
	`Scen` indicates scenery objects. These exist in multiple places; for example, the [~obj:MOSS] is visible from many locations near the entrance.
	`Glob` indicates a global object, which is *always* visible, or at least mentionable. For example, [~obj:GRUE] is global – not because grues are always present, but so you can always ask `WHAT IS A GRUE`.

obj:LOCAL-GLOBALS: This is a container for scenery objects like [~obj:MOSS], which are visible from many locations in the game.

src:GGLOBALS-26: This refers to the word `ZZMGCK` in [~obj:LOCAL-GLOBALS], above.
	Why is this synonym necessary? Does it need to be alphabetically last? Not clear! Most Infocom games have it (or a variation), but some say “No, this synonym doesn’t need to exist” instead.
	If you type `EXAMINE ZZMGCK`, the parser finds [~obj:local-globals]. But that object is nameless, so you get a garbage reply. Go on, try it.

obj:ADVENTURER: Yes, the player’s printed name is “cretin”, although the game rarely says so. (The death message for `ATTACK HEADS` mentions it.) This sort of sarcastic insult hasn’t aged too well, but MIT culture had a lot of it. Compare [*glob:WINNER], and also the old MIT [Jargon File|https://jargon-file.org/archive/jargon-1.0.0.33.dos.txt].
	Note that if you refer to `ME` (or `CRETIN`), you get the [*obj:ME] global object, not the `ADVENTURER`.

obj:ME: A global object which is always in scope. Commands referring to `ME` hit this, rather than [*obj:ADVENTURER], which is a stub that moves around the map.
	Because of this, parser messages mostly refer to you as “you”, even though the [*obj:ADVENTURER]’s printed name is “cretin”.

glob:PLAYER: `PLAYER` is always the [~obj:ADVENTURER]. Compare [*glob:WINNER].

glob:WINNER: `WINNER` is the actor in the current command. (Compare [*glob:PLAYER].) 
	`WINNER` is usually [~obj:ADVENTURER], but for a command like `ROBOT, GO EAST` it shifts to the named NPC.
	“Winner” is just as sarcastic as “[cretin|*obj:ADVENTURER]”, but from the other side.

glob:HERE: The location of the [*glob:WINNER].

glob:LIT: Whether the current location has light. Set by calling the [rtn:LIT?] routine.

glob:ALWAYS-LIT: Whether the player is inherently emitting light. The Wizard might cast `FLUORESCE` on you if he [finds you in the dark|src:2ACTIONS-3443].

rtn:LIT?: Determine whether a given location has light. This is true if the room or anything in it has [attr:ONBIT]. It’s also true if the player is [glob:ALWAYS-LIT].
	This routine is used to set the [glob:LIT] variable. It’s also used to determine visibility in some other situations. For example, if you peer out from inside a sphere, or look through the keyhole, the game checks whether you can see only darkness.

glob:LOW-DIRECTION: Properties with this value and above are directions.

attr:ONBIT: Set for glowing objects and naturally-illuminated rooms.
	This is different from [attr:LIGHTBIT], which indicates objects that the player can `TURN ON`. See also [attr:FLAMEBIT], objects which are on fire.

attr:FLAMEBIT: Set for objects which are on fire. Such objects normally also have [attr:ONBIT].
	This is different from [attr:BURNBIT], which indicates objects that the player can `BURN`.

attr:LIGHTBIT: Set for objects which the player can sensibly `TURN ON/OFF` (e.g. the [~obj:lamp]). Objects which have been `FLUORESCE`d also have this, although only to tell you “You can’t turn that off.”
	This is different from [attr:ONBIT], which indicates objects that are currently lit up. See also [attr:BURNBIT], objects which the player can `BURN`.

attr:BURNBIT: Set for objects which the player can `BURN`. (It might be a bad idea, but you can do it.)
	This is different from [attr:FLAMEBIT], which indicates objects that are currently on fire. See also [attr:LIGHTBIT], objects which the player can `TURN ON`.

attr:RLANDBIT: Set for rooms which are solid ground. (Most of them.) The alternative is [attr:NONLANDBIT], but several rooms have both.

attr:NONLANDBIT:Set for “rooms” in which you float in the air – or might float, at least. If the room has any walkable floor, it will also have [attr:RLANDBIT].
	This flag is also set for objects which are (temporarily) much larger than you. This happens to anything you’re not holding when you shrink yourself in the Tea Room.

attr:NWALLBIT: Set for “rooms” which are in the open air. The game does not use this flag for anything, however.

attr:STAGGERED: Set for valuable objects – not just the demon’s treasures, but the spheres, the wand, and the collar. However, the game generally relies on the [prop:VALUE] property rather than `STAGGERED`.

prop:VALUE: Set for valuable objects, and rooms which are difficult to reach. Picking up the object or entering the room awards you this many points. (And then the property is set to zero, to indicate that you’ve scored it.)
	Valuable objects also have the [attr:STAGGERED] flag, but the game almost never checks this.
	The `VALUE` property is also used to check whether the demon (and gnome, etc) approves of an object. The *value* of `VALUE` is not important here – just whether the property exists at all. (After all, any treasure you’re holding necessarily has `VALUE` zero.)

attr:SACREDBIT: Not used in Zork 2.

glob:SPRAYED?: Whether you’ve been sprayed with grue repellant.

glob:FANTASIES: A table of hallucinations which can result from the `FANTASIZE` spell. Unfortunately, the code that displays `FANTASIES` has been lost, so the spell has no effect! See the [PRINT-CONT|~src:GVERBS-1712] routine.

src:GVERBS-1712: In earlier versions of Zork 2, there was code here to display [~glob:FANTASIES] if you were under the `FANTASIZE` spell. Unfortunately, when renovating the Zorks in 1984, this code was somehow lost. The `FANTASIZE` spell is now broken.

glob:P-WON: Set if the parser successfully parsed a command. (As opposed to a blank line or an error.)
	No relation to whether the *player* has won; that’s [*glob:WON-FLAG].

glob:WON-FLAG: Set when you reach the [final room|~obj:ZORK3] (with the wand) and thus win the game. Since the game then ends immediately, the flag is only used in reporting your [final score|~src:2ACTIONS-3877].

glob:LUCKY: In Zork 2, you are always lucky.

glob:C-INTS: Indicates how much of the timer table ([*glob:C-TABLE]) is used. This counts down from `C-TABLELEN`, which is 180.

glob:C-DEMONS: Indicates how much of the timer table is used for daemons. (No relation to the wizard’s [demon|~obj:GENIE]!)
	The difference between daemons and timers is that timers run every turn; daemons run every *input*, even if no turn passes. But Zork 2 does not use daemons.

glob:C-TABLE: The timer table. See the “Timers” tab for a current listing.

TIMERS-LEGEND: A list of the timers running (or paused) in the timer table ([~glob:C-TABLE]). Positive numbers count down (while enabled) and call the named function after that many turns. Negative numbers are called every turn while the timer is enabled.
	This list only grows as you play; timers can be added, started, and stopped, but not removed.
	Note that enabled negative timers, like [*rtn:I-SWORD], count down towards “negative infinity”. They’ll wrap and stop working after 65535 turns, but back then nobody worried about this!

rtn:GO: Set up the world at the start of the game. Start the timers. Print the banner. Set all those useful globals like [~glob:HERE] and [~glob:PLAYER].


obj:GENIE: The game generally refers to the Big Bad as a “demon”, but “genie” is occasionally used as well.

obj:SWORD: The sword has [PROP:VALUE] zero. Any object with a `VALUE` property is considered a treasure (even if the value is zero). This means that the sword is accepted as a gift by the [gnomes|~rtn:GNOME-FCN], the [dragon|~src:2ACTIONS-2376]... and the genie. See [this bug|src:2ACTIONS-3259].

rtn:I-SWORD: This routine runs every turn that you are carrying the [obj:SWORD]. It checks adjacent rooms for enemies and displays the “sword is glowing” message.
	The sword’s glow level is stored in the [glob:SWORD-GLOW] variable.

glob:SWORD-GLOW: Set by [rtn:I-SWORD].

const:TREASURES-MAX: The number of treasures that the genie desires. See [this bug|src:2ACTIONS-3259].

src:2ACTIONS-3259: The genie accepts any object with the [PROP:VALUE] property. As noted at [~const:TREASURES-MAX], his treasure count does *not* include the [spheres|~obj:PALANTIR-1], the [candy|~obj:CANDY], the [collar|~obj:COLLAR], and the [wand|~obj:WAND]. Those objects are used up or unreachable while the genie is active.
	However, in this version of Zork 2, the [~obj:SWORD] also has the [PROP:VALUE] property. So you can use it to bribe the [gnomes|~rtn:GNOME-FCN], which makes sense – and the genie, which doesn’t!
	By offering the sword to the genie, you can skip collecting any of the other treasures. Or give the sword to the genie as a bonus, and win the game with 402 points.

rtn:I-LANTERN: This routine sits in the timers table. When it fires, it prints a “lantern has gotten dimmer” message and re-queues itself for the next dimming stage. (Until the lantern goes out entirely, of course.) The messages themselves (and their durations) are found in [*glob:LAMP-TABLE].

glob:LAMP-TABLE: This table shows the successive stages of the lamp going out. The *first* stage is 200 turns, which is set in [~rtn:GO], not here.

rtn:I-MATCH: This routine runs every turn the match is lit – which is not very long; it only burns for one turn. ([Two|~src:2ACTIONS-1888], including the turn you light it.)
	But see [this bug|src:2ACTIONS-3956].

rtn:KILL-INTERRUPTS: If you die, the game shuts down active timers. This prevents strange lingering events (like gnome or dragon activity) after you emerge from the “afterlife” of the spheres.
	But see [this bug|src:2ACTIONS-3956].

src:2ACTIONS-3956: The game shuts down [rtn:I-MATCH] when you die. This is good, in that you don’t get spurious messages about the match going out in the afterlife. But it’s bad in that the matchbook is left with [attr:ONBIT]! You can use it as a permanent light source thereafter.
	(c:Monica Morse)

rtn:I-WIZARD: This routine is the [~obj:WIZARD]’s heartbeat. Every four turns (normally), he has a chance of showing up and casting something irritating on you. The Wizard also has a number of other possible reactions, depending on your current situation.
	Once a spell has been cast on you, this routine acts as the timer for its expiration. Then it goes back to handling the Wizard.
	(Want to [test the Wizard’s spells|TRY-SPELL]?)

src:2ACTIONS-3443: If you are in the dark, your lamp is busted, and your score is over 200, the Wizard may “helpfully” cast `FLUORESCE` on you. This sets [glob:ALWAYS-LIT].
	(The flag is never removed, so the spell is permanent. This will cause you trouble in the Crypt.)

src:2ACTIONS-3484: The more spheres you carry, the less likely the Wizard is to cast a spell on you.

glob:SPELL?: If you are currently the victim of a spell, this says which it is. The values are the constants defined under [~const:SPELLS].
	(This does not include `FLUORESCE`, which is instead indicated by [glob:ALWAYS-LIT].)

const:SPELLS: The number of spells that the Wizard might randomly afflict you with.

glob:SPELL-NAMES: The printed names of the spells defined under [~const:SPELLS].

glob:SPELL-HINTS: These messages are used when the Wizard casts a spell on you.

glob:SPELL-STOPS: These messages are used when a spell expires.

obj:PALANTIR-1: The game lets you refer to the spheres as `PALANTIRS`, but it doesn’t do so itself. No doubt the specter of Tolkien lawsuits loomed large. (Similarly, you can refer to the [~obj:SWORD] as `ORCRIST` or `GLAMDRING` if you want to be a nerd.)

obj:PALANTIR-2: The game lets you refer to the spheres as `PALANTIRS`, but it doesn’t do so itself. No doubt the specter of Tolkien lawsuits loomed large. (Similarly, you can refer to the [~obj:SWORD] as `ORCRIST` or `GLAMDRING` if you want to be a nerd.)

obj:PALANTIR-3: The game lets you refer to the spheres as `PALANTIRS`, but it doesn’t do so itself. No doubt the specter of Tolkien lawsuits loomed large. (Similarly, you can refer to the [~obj:SWORD] as `ORCRIST` or `GLAMDRING` if you want to be a nerd.)

obj:PALANTIR-4: The game lets you refer to the spheres as `PALANTIRS`, but it doesn’t do so itself. No doubt the specter of Tolkien lawsuits loomed large. (Similarly, you can refer to the [~obj:SWORD] as `ORCRIST` or `GLAMDRING` if you want to be a nerd.)

rtn:I-SPHERE: This is the timer routine for dying in the [cage|~obj:IN-CAGE].


src:2ACTIONS-176: This section handles much of the [~obj:RECEPTACLE] logic. However, it only applies when you are *in* the [~obj:BALLOON]. (The player’s location can override actions in the `M-BEG` phase of [PERFORM|~src:GMAIN-196].) The receptacle is reachable from outside the balloon, which leads to a few bugs.
	(c:Torbjörn Andersson)

src:2ACTIONS-271: The description aligns neatly with the [CANYON-VIEW|relative:../zork1/#OBJ:CANYON-VIEW] in Zork 1.


src:2ACTIONS-2480: This check prevents the dragon from following you into the Ledge, the Fresco Room, or the Carousel Room. This effectively hems him into a few rooms (Dragon Room, Stone Bridge, Cool Room, Ice Room).
	...Except there’s a hole in the logic. If you raise [~glob:DRAGON-ANGER] to 4, it will take *two* turns to decline to zero – which means you can move *through* one of the blocked rooms. The dragon will still follow you to the far side. This allows you to bring the dragon practically anywhere in the game.
	(c:Torbjörn Andersson)


obj:COIN: The source has wonderful ASCII-art renditions of some of the treasures. These are carried over from MIT Zork, but they are commented out here – no doubt to save space.
	The art doesn’t render very well in the source pane, but you can see the original coin [here|relative:pic/coin-art.png].

obj:STAMP: The source has wonderful ASCII-art renditions of some of the treasures. These are carried over from MIT Zork, but they are commented out here – no doubt to save space.
	The art doesn’t render very well in the source pane, but you can see the original stamp [here|relative:pic/stamp-art.png].

obj:BILLS: The source has wonderful ASCII-art renditions of some of the treasures. These are carried over from MIT Zork, but they are commented out here – no doubt to save space.
	The art doesn’t render very well in the source pane, but you can see the original bills [here|relative:pic/bills-art.png].

obj:PORTRAIT: The source has wonderful ASCII-art renditions of some of the treasures. These are carried over from MIT Zork, but they are commented out here – no doubt to save space.
	The art doesn’t render very well in the source pane, but you can see the original portrait [here|relative:pic/portrait-art.png].


obj:DIAMOND-5: The Map tab shows the rooms as laid out by their direction properties. ([~obj:DIAMOND-2] is `NORTH` of [~obj:DIAMOND-5] and so on.) But the puzzle solution has nothing to do with this layout! See [rtn:DIAMOND-MOTION].
	Once the maze is solved ([~glob:DIAMOND-SOLVE]), you are no longer confused and movement follows the map as shown.

rtn:DIAMOND-MOTION: Everybody loves a [maze|com-maze-1].
	This routine handles travel in the Oddly-angled Rooms, and the mechanics of solving it.
	Let’s follow the logic...
	...Is the maze [solved|*src:2ACTIONS-2185] or [unsolved|*src:2ACTIONS-2187]? This is the [~glob:DIAMOND-SOLVE] variable.
	
src:2ACTIONS-2185: If the maze is solved, [rtn:DIAMOND-MOTION] returns with no special effect. Travel then follows normal directions. From the [center room|~obj:DIAMOND-5], you can go both `UP` and `DOWN`.

src:2ACTIONS-2187: If the maze is still unsolved...
	...are you in an [even room|src:2ACTIONS-2190] or an [odd room|src:2ACTIONS-2213]?

src:2ACTIONS-2190: If you are in an even room (2/4/6/8)...
	Have you made the [correct next move|src:2ACTIONS-2191] or a [wrong move|src:2ACTIONS-2210]?
	The correct next move is defined by [~glob:DIDIRS]). You must first move `SE`, then `NE`, then `NW`, then `SW`.
	Note that it doesn’t at all matter *which* even room you’re in. Indeed, if you weren’t playing in the Visible Zorker, you would have no way to tell!

src:2ACTIONS-2191: For a correct move, we increment [~glob:DIAMOND-COUNT]. If that reaches 5 (meaning you’ve made your fourth correct move in a row), we also set [~glob:DIAMOND-SOLVE]. Good job!
	Regardless, we then transport you along the cycle of even rooms: 2 → 4 → 8 → 6 → 2. Again, this has nothing to do with the move you just made.

src:2ACTIONS-2210: A wrong move from an even room always calls [rtn:DIAMOND-LOSS].

src:2ACTIONS-2213: If you are in an odd room (1/3/5/7/9)...
	...did you [go up from the center|src:2ACTIONS-2215]? (The exit stairs.)
	...or did you [make any other move at all|src:2ACTIONS-2216]?

src:2ACTIONS-2215: Going `UP` from the [center room|~obj:DIAMOND-5] always works. (This is how you return to the [Menhir Room|~obj:MENHIR-ROOM].) Of course, *finding* the center room is tricky! It’s only a 20% chance in [rtn:DIAMOND-LOSS].

src:2ACTIONS-2216: Any move in an odd room (aside from `UP` the center stairs) gives a completely random result. Roll a die! (Notionally.)
	...[rolled 1 or 2|src:2ACTIONS-2219]?
	...[rolled 3|src:2ACTIONS-2222]?
	...[rolled 4, 5, 6|src:2ACTIONS-2226]?

src:2ACTIONS-2219: After any move in an odd room, you have a 33% chance of a “can’t go that way” message.

src:2ACTIONS-2222: After any move in an odd room, you have a 16% chance of [rtn:DIAMOND-LOSS].
	(Yeah, the code says `PROB 25`. But that’s after the [33% chance above|~src:2ACTIONS-2216] has failed.)

src:2ACTIONS-2226: After any move in an odd room, you have a 50% chance of being sent to a random *even* room.
	If the [~obj:BAT] hasn’t yet turned up, it will turn up now. (But if you leave the bat alone, it will remain in that even room thereafter.)

rtn:DIAMOND-LOSS: This handles some of the false moves in the maze. (Not all of them!)
	We increment [~glob:DIAMOND-MOVES], which counts up towards the Wizard appearing to taunt you. Then we transport the player to a randomly-selected odd room (1/3/5/7/9).
	Note that this is the only way to return to the [stairway|obj:DIAMOND-5] if the maze is unsolved. And that’s only a 20% chance. Inconsiderate!

glob:DIAMOND-MOVES: This tracks how many wrong moves you’ve made in the maze. At 20, the Wizard [taunts you|~rtn:DIAMOND-LOSS].

glob:DIAMOND-BASE: This tracks the farthest progress you’ve ever made in the maze. The Wizard uses this as part of his taunt: “You’ll never get past *second* base!”


rtn:I-BUCKET: When you pour water into the bucket, it slowly evaporates. This timer routine handles its eventual disappearance.

src:2ACTIONS-844: “Kick the bucket,” as in “die.” Get it?

glob:EVAPORATED: If set, the bucket is descending because the water evaporated (rather than because you removed the water yourself).

src:2ACTIONS-789: This move can’t happen. See [obj:SALTY-WATER].

src:2ACTIONS-791: You can lower the bucket with `GET WATER`. This is pragmatic – otherwise you’d have to wait for the water to [evaporate|rtn:I-BUCKET]. But scraping a puddle into a teapot makes no physical sense. Yes, this bothered me when I was twelve.

obj:FOOTPAD: There is no footpad. (The Thief died in Zork 1, remember?) This object exists so that you can ask `WHAT IS A FOOTPAD` after reading the sign in the [~obj:CAGE-ROOM].

obj:SALTY-WATER: This is supposed to represent water from the [~obj:POOL-ROOM]. However, the logic in [WATER-FCN|~src:2ACTIONS-789] doesn’t work; it’s impossible to take the `SALTY-WATER`. So the object is useless.
	(In previous versions of Zork 2, you could get the `SALTY-WATER`, but it was very buggy.)


src:2ACTIONS-2937: Trying to unlock the door while the lizard is awake gives a 5% chance of losing the [~obj:GOLD-KEY] and a 20% chance of dropping it.
	Mind you, nothing checks whether you *had* the key. This code runs even for `UNLOCK DOOR WITH SWORD`! This lets you purloin the key from the unicorn. Sort of. (The game still thinks the unicorn owns it.)
	(c:Torbjörn Andersson)


obj:IN-AQUARIUM: You can’t enter the aquarium (and live). The room only exists to provide a description for peering into the blue sphere.


FILES-LEGEND: The last file, crufty.zil, is a bit odd. See [this note|src:ZORK2-34].

src:CRUFTY-1: Weirdly, nothing ever includes this file. See [zork.zil|src:ZORK2-34].
	The [rtn:I-LANTERN] routine is definitely part of the game file. So we know the compiler read this file in. But it’s not obvious how.

src:ZORK2-34: Notice something missing? There’s no `IFILE` line (“include file”) for [crufty.zil|~src:CRUFTY-1].
	The [rtn:I-LANTERN] routine is definitely part of the game file. So we know the compiler read crufty.zil in. But it’s not obvious how.
	Furthermore, when I analyzed the game file, I found that functions were *not* generated in the order of the `IFILE` lines here. (In Zork 1, functions *were* generated in `IFILE` order.)
	My best guess is that the zork2.zil file was rewritten after July 26 1984, but the game was never recompiled.

rtn:ZPROB: This function is never called.
	Every die-roll in Zork 2 uses the one-argument form of [PROB|~src:GMACROS-118]. That’s compiled as an inlined `@RANDOM` opcode, not `ZPROB`.
	`ZPROB` has extra logic to decrease your chance of success if you are un-[glob:LUCKY]. But nothing in the game makes you un-[glob:LUCKY], so this is never needed.

glob:DUMMY: `DUMMY` gives random responses for silly commands, like `CLOSE DOOR` when the door isn’t open.
	This table is defined in two places in the source, with different contents. See [GVERBS|~src:GVERBS-2133]. The compiler apparently didn’t report this as an error, and the developers didn’t notice.

src:GVERBS-2133: The [~glob:DUMMY] table is defined elsewhere, so this declaration has no effect.
	I’ve colored it grey, as if it were not compiled, but that’s not strictly correct. This version of the table can be found in memory (address 10795); but nothing refers to it, so its contents are never printed.

src:GVERBS-912: This is clearly intended to be the response to `ODYSSEUS`, but it is never printed. In fact the compiler has discarded the string entirely. The `CYCLOPS` code above, which is only compiled in Zork 1, seems to have confused the rest of the function.
	(Interestingly, the carriage return `CR` *is* printed. So the compiler didn’t discard the entire line – only the string. See [rtn:BLAST] for a similar incident.)

rtn:BLAST: This provides a custom response in the Dusty Room. Sadly, the `BLAST` routine is never called, so the effort is wasted. (The command `BLAST` is handled by [~rtn:V-BLAST].)
	The compiler has discarded the string but not the routine, which is an interesting optimization choice.

src:GVERBS-523: You can cast `FLUORESCE` with the wand, but the implementation is a bit broken. First, the spell is permanent; it’s not removed in [~rtn:V-DISENCHANT]. Fair enough – it’s permanent when the [Wizard casts it|glob:ALWAYS-LIT] too. But it also sets `LIGHTBIT`, meaning the player can then turn the fluorescing object on and off at will!


COM-MAZE-1: You are in a small room with evenly-angled walls.
	You can go [north|COM-MAZE-4], [east|COM-MAZE-2], or [west|COM-MAZE-3].

COM-MAZE-2: You are in a small room with evenly-angled walls.
	You can go [south|COM-MAZE-1], [down|COM-MAZE-3], or [north|COM-MAZE-1].

COM-MAZE-3: You are in a small room with evenly-angled walls.
	You can go [west|COM-MAZE-2], [northwest|COM-MAZE-1], or [north|COM-MAZE-1].

COM-MAZE-4: You are in a small room with evenly-angled walls.
	You can go [west|COM-MAZE-5], [northeast|COM-MAZE-6], or [north|COM-MAZE-7].

COM-MAZE-5: You are in a small room with evenly-angled walls.
	You can go [southeast|COM-MAZE-6], [north|COM-MAZE-4], or [east|COM-MAZE-6].

COM-MAZE-6: You are in a small room with evenly-angled walls.
	You can go [north|COM-MAZE-4], [south|COM-MAZE-5], or [up|COM-MAZE-5].

COM-MAZE-7: You are in a small room with evenly-angled walls.
	You can go [down|COM-MAZE-8], [north|COM-MAZE-10], or [east|COM-MAZE-9].

COM-MAZE-8: You are in a small room with evenly-angled walls.
	You can go [north|COM-MAZE-7], [west|COM-MAZE-9], or [east|COM-MAZE-9].

COM-MAZE-9: You are in a small room with evenly-angled walls.
	You can go [up|COM-MAZE-8], [west|COM-MAZE-8], or [north|COM-MAZE-7].

COM-MAZE-10: You are in a small room with evenly-angled walls.
	You can go [north|COM-MAZE-13], [west|COM-MAZE-11], or [southeast|COM-MAZE-12].

COM-MAZE-11: You are in a small room with evenly-angled walls.
	You can go [south|COM-MAZE-12], [down|COM-MAZE-12], or [north|COM-MAZE-10].

COM-MAZE-12: You are in a small room with evenly-angled walls.
	You can go [south|COM-MAZE-11], [north|COM-MAZE-10], or [northeast|COM-MAZE-11].

COM-MAZE-13: You have reached a dead end. There is a massive vending machine here.
	[Press the button|BATTERIES] to receive fresh batteries for your lantern!

BATTERIES: Your lantern is now refreshed.
	(Take a look at the “Timers” tab.)

TRY-SPELL: The Wizard has a list of twelve [spells|~glob:SPELL-NAMES] that he casts on you. Select one:
	“[Feeble|TRY-SPELL-FEEBLE]”, “[Fumble|TRY-SPELL-FUMBLE]”, “[Fear|TRY-SPELL-FEAR]”, “[Filch|TRY-SPELL-FILCH]”, “[Freeze|TRY-SPELL-FREEZE]”, “[Fall|TRY-SPELL-FALL]”, “[Ferment|TRY-SPELL-FERMENT]”, “[Fierce|TRY-SPELL-FIERCE]”, “[Float|TRY-SPELL-FLOAT]”, “[Fireproof|TRY-SPELL-FIREPROOF]”, “[Fence|TRY-SPELL-FENCE]”, “[Fantasize|TRY-SPELL-FANTASIZE]”. Or “[Fluoresce|TRY-SPELL-FLUORESCE]”, which he only casts in [specific circumstances|src:2ACTIONS-3443].

TRY-SPELL-FEEBLE: The Wizard will cast “Feeble” at the next opportunity.

TRY-SPELL-FUMBLE: The Wizard will cast “Fumble” at the next opportunity.

TRY-SPELL-FEAR: The Wizard will cast “Fear” at the next opportunity.

TRY-SPELL-FILCH: The Wizard will cast “Filch” at the next opportunity.

TRY-SPELL-FREEZE: The Wizard will cast “Freeze” at the next opportunity.

TRY-SPELL-FALL: The Wizard will cast “Fall” at the next opportunity.

TRY-SPELL-FERMENT: The Wizard will cast “Ferment” at the next opportunity.

TRY-SPELL-FIERCE: The Wizard will cast “Fierce” at the next opportunity.

TRY-SPELL-FLOAT: The Wizard will cast “Float” at the next opportunity.

TRY-SPELL-FIREPROOF: The Wizard will cast “Fireproof” at the next opportunity.

TRY-SPELL-FENCE: The Wizard will cast “Fence” at the next opportunity.

TRY-SPELL-FANTASIZE: The Wizard will cast “Fantasize” at the next opportunity. But remember that this spell [does not work|src:GVERBS-1712] in this release of Zork 2.

TRY-SPELL-FLUORESCE: You are now glowing, as if the Wizard had cast `FLUORESCE` on you.
	(This is an out-of-band update to the game state. Type `LOOK` to see the effect.)

TRY-SPELL-FLUORESCE-ALREADY: You are already fluorescing. Do you want to [cancel the spell|TRY-SPELL-FLUORESCE-END]?
	(This is cheating; `FLUORESCE` is supposed to be permanent.)

TRY-SPELL-FLUORESCE-END: You are no longer glowing.
	(This is an out-of-band update to the game state. You will not see the effect until the end of the next turn.)

TRY-SPELL-TOO-LATE: The Wizard no longer casts spells at this stage of the game.

TRY-SPELL-FAIL: Something went wrong with the test.

